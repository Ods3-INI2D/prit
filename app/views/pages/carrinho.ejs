<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho</title>
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/carrinho.css">
</head>
<body>
    <header>
        <%- include('../partial/grid.ejs') %>
    </header>

    <main>
        <section class="carrinho-container">
            <h1 class="titulo-carrinho">Meu Carrinho</h1>

            <% if(carrinho.length === 0) { %>
                <article class="carrinho-vazio">
                    <p class="mensagem-vazio">Seu carrinho est√° vazio!</p>
                    <a href="/home" class="btn-continuar">Continuar Comprando</a>
                </article>
            <% } else { %>
                <ul class="lista-carrinho">
                    <% 
                    let total = 0;
                    carrinho.forEach(function(produto) { 
                        const precoFinal = produto.precoDesconto || produto.preco;
                        total += precoFinal;
                    %>
                        <li class="item-carrinho">
                            <img src="<%= produto.imagem %>" alt="<%= produto.nome %>" class="imagem-produto">
                            
                            <article class="info-produto">
                                <h2 class="nome-produto"><%= produto.nome %></h2>
                                <p class="categoria-produto"><%= produto.categoria %></p>
                                
                                <% if(produto.precoDesconto) { %>
                                    <p class="preco-original">R$ <%= produto.preco.toFixed(2) %></p>
                                    <p class="preco-desconto">R$ <%= produto.precoDesconto.toFixed(2) %></p>
                                <% } else { %>
                                    <p class="preco-produto">R$ <%= produto.preco.toFixed(2) %></p>
                                <% } %>
                            </article>

                            <article class="avaliar-container">
                                <a href="/produto/<%= produto.id %>#avaliar" class="btn-avaliar">Avaliar Produto</a>
                            </article>
                        </li>
                    <% }); %>
                </ul>

                <section class="resumo-carrinho">
                    <article class="total-container">
                        <h3 class="label-total">Total:</h3>
                        <p class="valor-total">R$ <%= total.toFixed(2) %></p>
                    </article>

                    <button class="btn-finalizar">Finalizar Compra</button>
                </section>
            <% } %>
        </section>
    </main>

    <footer>
        <%- include('../partial/footer.ejs') %>
    </footer>
</body>
</html>